mailster=function(t,a,e,n){"use strict";var s=[],i=false,r=a("tr.type-newsletter"),o=a("#bulk-action-selector-top"),c=a("#bulk-action-selector-bottom");t.$.document.on("submit","#posts-filter",function(){var a=o.val(),e=c.val(),n=a!=-1?a:e!=-1?e:false;switch(n){case"finish":return confirm(t.l10n.campaigns.finish_campaigns);break;case"start":return confirm(t.l10n.campaigns.start_campaigns);break}}).on("click","a.live-action",function(){if(a(this).hasClass("finish")&&!confirm(t.l10n.campaigns.finish_campaign)){return false}var e=a(this).parent().parent().parent().addClass("loading");a.get(a(this).attr("href"),function(){setTimeout(function(){wp.heartbeat.connectNow()},500)});return false}).on("scroll",function(){clearTimeout(i);i=setTimeout(function(){wp.heartbeat.connectNow()},400)}).on("change",".hide-column-tog",function(){wp.heartbeat.connectNow()}).on("click",".toggle-row",function(){var t=a(this).parent().parent().attr("id").substring(5);if(s[t]){s[t]=[]}wp.heartbeat.connectNow()}).on("heartbeat-send",function(e,n){var i=[],o;r.each(function(){o=parseInt(a(this).find("input").eq(0).val(),10);s[o]=s[o]||{};if(t.util.inViewport(this))i.push(o)});n["mailster"]={page:"overview",ids:i,columns:a(".hide-column-tog:checked").map(function(){return this.value}).toArray()}}).on("heartbeat-tick",function(t,e){var n=false;if(e["mailster"]){if(!s){s=a.extend(e["mailster"],s);n=true}var i=false,o=0;a.each(r,function(t,r){var c;r=a(r);t=r.attr("id").replace("post-","");r.removeClass("loading");if(!e["mailster"][t])return;c=e["mailster"][t];r.find(".column-status")[c.cron?"removeClass":"addClass"]("cron-issue");r.find(".campaign-status").html(c.cron?"":c.status_title);a.each(c,function(a,e){if(!n&&s[t][a]==e)return;var l=s[t]&&s[t].status&&(c.status!=s[t].status||c.is_active!=s[t].is_active);switch(a){case"status":if(l){r.removeClass("status-"+s[t].status).addClass("status-"+c.status)}case"sent":case"total":case"sent_formatted":break;case"column-status":if(c.status=="active"&&!l){var u=r.find(".campaign-progress"),f=Math.round(c.sent/c.total*100);u.find(".bar").width(f+"%");u.find("span").eq(1).html(c.sent_formatted);u.find("span").eq(2).html(c.sent_formatted);u.find("var").html(f+"%")}if(!l)break;default:var m=r.find("."+a);if(!m.is(":visible"))break;m.fadeTo(10,.01,function(){m.html(e).delay(10*o++).fadeTo(200,1)})}i=true})});if(i)wp.heartbeat.interval("fast");s=a.extend(s,e["mailster"])}});wp.heartbeat.interval("fast");if(wp.heartbeat.connectNow)wp.heartbeat.connectNow();return t}(mailster||{},jQuery,window,document);